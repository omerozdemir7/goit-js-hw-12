{"version":3,"file":"index.js","sources":["../src/js/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios'; // 1. Axios import edildi\n\n// --- DOM Seçicileri ---\nconst searchForm = document.querySelector('#search-form');\nconst galleryContainer = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst loaderText = document.querySelector('.loader-text');\nconst loadMoreBtn = document.querySelector('.load-more-btn'); // \"Load more\" düğmesi seçicisi\n\n// --- API ve Durum (State) Değişkenleri ---\nconst API_KEY = '32475203-0397f154fda8b2c2a6bae1f0a';\nconst BASE_URL = 'https://pixabay.com/api/';\nconst PER_PAGE = 40; // İstek başına 40 sonuç\n\nlet currentPage = 1;\nlet currentQuery = '';\nlet totalHits = 0;\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\n// --- Olay Dinleyicileri ---\nsearchForm.addEventListener('submit', onSearchSubmit);\nloadMoreBtn.addEventListener('click', onLoadMore);\n\n// --- Yeni Arama Fonksiyonu ---\nasync function onSearchSubmit(event) {\n  event.preventDefault();\n  const form = event.currentTarget;\n  const searchQuery = form.elements.searchQuery.value.trim();\n\n  if (!searchQuery) {\n    iziToast.error({\n      title: 'Hata',\n      message: 'Arama kutusu boş olamaz!',\n      position: 'topRight',\n    });\n    return;\n  }\n\n  // Yeni arama için durumu sıfırla\n  currentQuery = searchQuery;\n  currentPage = 1;\n  galleryContainer.innerHTML = ''; // Galeriyi temizle\n  hideLoadMoreBtn(); // Düğmeyi gizle\n  showLoader(); // Yükleyiciyi göster\n\n  try {\n    const data = await fetchImages(currentQuery, currentPage);\n    totalHits = data.totalHits; // Toplam sonuç sayısını sakla\n\n    if (totalHits === 0) {\n      iziToast.info({\n        title: 'Bilgi',\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n      });\n    } else {\n      renderGallery(data.hits); // İlk sayfa sonuçlarını render et\n      lightbox.refresh(); // Lightbox'ı güncelle\n      checkEndAndUpdateButton(); // Sonuçların sonuna gelinip gelinmediğini kontrol et\n    }\n  } catch (error) {\n    handleError(error);\n  } finally {\n    hideLoader(); // Yükleyiciyi gizle\n    form.reset();\n  }\n}\n\n// --- \"Daha Fazla Yükle\" Fonksiyonu ---\nasync function onLoadMore() {\n  currentPage += 1; // Sayfa numarasını artır\n  hideLoadMoreBtn(); // Düğmeyi gizle\n  showLoader(); // Yükleyiciyi göster\n\n  try {\n    const data = await fetchImages(currentQuery, currentPage);\n    renderGallery(data.hits); // Yeni görselleri galeriye ekle\n    lightbox.refresh(); // Lightbox'ı güncelle\n    smoothScroll(); // Sayfayı kaydır\n    checkEndAndUpdateButton(); // Sonuçların sonuna gelinip gelinmediğini kontrol et\n  } catch (error) {\n    handleError(error);\n  } finally {\n    hideLoader(); // Yükleyiciyi gizle\n  }\n}\n\n// --- API İsteği (Axios ile yeniden düzenlendi) ---\nasync function fetchImages(query, page) {\n  // Axios için 'params' nesnesi\n  const params = {\n    key: API_KEY,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n    page: page,\n    per_page: PER_PAGE, // Sayfa başına 40 sonuç\n  };\n\n  // Axios GET isteği\n  const response = await axios.get(BASE_URL, { params });\n  return response.data; // Axios, .json() işlemini otomatik yapar\n}\n\n// --- Galeri Render Fonksiyonu (Ekleme yapacak şekilde güncellendi) ---\nfunction renderGallery(images) {\n  const markup = images\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `<li class=\"gallery-item\">\n          <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\"/>\n          </a>\n          <div class=\"info\">\n            <p class=\"info-item\"><b>Likes</b> ${likes}</p>\n            <p class=\"info-item\"><b>Views</b> ${views}</p>\n            <p class=\"info-item\"><b>Comments</b> ${comments}</p>\n            <p class=\"info-item\"><b>Downloads</b> ${downloads}</p>\n          </div>\n        </li>`\n    )\n    .join('');\n  // innerHTML yerine insertAdjacentHTML kullanarak mevcut içeriğin üzerine ekle\n  galleryContainer.insertAdjacentHTML('beforeend', markup);\n}\n\n// --- Yardımcı Fonksiyonlar ---\n\nfunction showLoader() {\n  loader.classList.remove('hidden');\n  loaderText.classList.remove('hidden');\n}\n\nfunction hideLoader() {\n  loader.classList.add('hidden');\n  loaderText.classList.add('hidden');\n}\n\nfunction showLoadMoreBtn() {\n  loadMoreBtn.classList.remove('hidden');\n}\n\nfunction hideLoadMoreBtn() {\n  loadMoreBtn.classList.add('hidden');\n}\n\n// Sonuçların sonunu kontrol eden fonksiyon\nfunction checkEndAndUpdateButton() {\n  if (currentPage * PER_PAGE >= totalHits) {\n    hideLoadMoreBtn(); // Düğmeyi gizle\n    if (totalHits > 0) {\n      // Sadece galeri boş değilse bu mesajı göster\n      iziToast.info({\n        title: 'Bilgi',\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n    }\n  } else {\n    showLoadMoreBtn(); // Daha fazla sonuç varsa düğmeyi göster\n  }\n}\n\n// Düzgün kaydırma fonksiyonu\nfunction smoothScroll() {\n  const firstCard = galleryContainer.querySelector('.gallery-item');\n  if (firstCard) {\n    const cardHeight = firstCard.getBoundingClientRect().height;\n    window.scrollBy({\n      top: cardHeight * 2, // İki kart yüksekliği kadar kaydır\n      behavior: 'smooth', // Düzgün (smooth) animasyon\n    });\n  }\n}\n\n// Hata yönetimi\nfunction handleError(error) {\n  iziToast.error({\n    title: 'Hata',\n    message: `Bir hata oluştu: ${error.message}`,\n    position: 'topRight',\n  });\n  console.error('Fetch Error:', error);\n}"],"names":["searchForm","galleryContainer","loader","loaderText","loadMoreBtn","API_KEY","BASE_URL","PER_PAGE","currentPage","currentQuery","totalHits","lightbox","SimpleLightbox","onSearchSubmit","onLoadMore","event","form","searchQuery","iziToast","hideLoadMoreBtn","showLoader","data","fetchImages","renderGallery","checkEndAndUpdateButton","error","handleError","hideLoader","smoothScroll","query","page","params","axios","images","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","showLoadMoreBtn","firstCard","cardHeight"],"mappings":"owBAOA,MAAMA,EAAa,SAAS,cAAc,cAAc,EAClDC,EAAmB,SAAS,cAAc,UAAU,EACpDC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAa,SAAS,cAAc,cAAc,EAClDC,EAAc,SAAS,cAAc,gBAAgB,EAGrDC,EAAU,qCACVC,EAAW,2BACXC,EAAW,GAEjB,IAAIC,EAAc,EACdC,EAAe,GACfC,EAAY,EAEhB,MAAMC,EAAW,IAAIC,EAAe,aAAc,CAChD,aAAc,MACd,aAAc,GAChB,CAAC,EAGDZ,EAAW,iBAAiB,SAAUa,CAAc,EACpDT,EAAY,iBAAiB,QAASU,CAAU,EAGhD,eAAeD,EAAeE,EAAO,CACnCA,EAAM,eAAc,EACpB,MAAMC,EAAOD,EAAM,cACbE,EAAcD,EAAK,SAAS,YAAY,MAAM,KAAI,EAExD,GAAI,CAACC,EAAa,CAChBC,EAAS,MAAM,CACb,MAAO,OACP,QAAS,2BACT,SAAU,UAChB,CAAK,EACD,MACF,CAGAT,EAAeQ,EACfT,EAAc,EACdP,EAAiB,UAAY,GAC7BkB,IACAC,IAEA,GAAI,CACF,MAAMC,EAAO,MAAMC,EAAYb,EAAcD,CAAW,EACxDE,EAAYW,EAAK,UAEbX,IAAc,EAChBQ,EAAS,KAAK,CACZ,MAAO,QACP,QACE,2EACF,SAAU,UAClB,CAAO,GAEDK,EAAcF,EAAK,IAAI,EACvBV,EAAS,QAAO,EAChBa,IAEJ,OAASC,EAAO,CACdC,EAAYD,CAAK,CACnB,QAAC,CACCE,IACAX,EAAK,MAAK,CACZ,CACF,CAGA,eAAeF,GAAa,CAC1BN,GAAe,EACfW,IACAC,IAEA,GAAI,CACF,MAAMC,EAAO,MAAMC,EAAYb,EAAcD,CAAW,EACxDe,EAAcF,EAAK,IAAI,EACvBV,EAAS,QAAO,EAChBiB,IACAJ,GACF,OAASC,EAAO,CACdC,EAAYD,CAAK,CACnB,QAAC,CACCE,GACF,CACF,CAGA,eAAeL,EAAYO,EAAOC,EAAM,CAEtC,MAAMC,EAAS,CACb,IAAK1B,EACL,EAAGwB,EACH,WAAY,QACZ,YAAa,aACb,WAAY,OACZ,KAAMC,EACN,SAAUvB,CACd,EAIE,OADiB,MAAMyB,EAAM,IAAI1B,EAAU,CAAE,OAAAyB,EAAQ,GACrC,IAClB,CAGA,SAASR,EAAcU,EAAQ,CAC7B,MAAMC,EAASD,EACZ,IACC,CAAC,CACC,aAAAE,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACR,IAAY;AAAA,0CAC8BL,CAAa;AAAA,8CACTD,CAAY,UAAUE,CAAI;AAAA;AAAA;AAAA,gDAGxBC,CAAK;AAAA,gDACLC,CAAK;AAAA,mDACFC,CAAQ;AAAA,oDACPC,CAAS;AAAA;AAAA,cAG7D,EACK,KAAK,EAAE,EAEVxC,EAAiB,mBAAmB,YAAaiC,CAAM,CACzD,CAIA,SAASd,GAAa,CACpBlB,EAAO,UAAU,OAAO,QAAQ,EAChCC,EAAW,UAAU,OAAO,QAAQ,CACtC,CAEA,SAASwB,GAAa,CACpBzB,EAAO,UAAU,IAAI,QAAQ,EAC7BC,EAAW,UAAU,IAAI,QAAQ,CACnC,CAEA,SAASuC,GAAkB,CACzBtC,EAAY,UAAU,OAAO,QAAQ,CACvC,CAEA,SAASe,GAAkB,CACzBf,EAAY,UAAU,IAAI,QAAQ,CACpC,CAGA,SAASoB,GAA0B,CAC7BhB,EAAcD,GAAYG,GAC5BS,IACIT,EAAY,GAEdQ,EAAS,KAAK,CACZ,MAAO,QACP,QAAS,6DACT,SAAU,UAClB,CAAO,GAGHwB,GAEJ,CAGA,SAASd,GAAe,CACtB,MAAMe,EAAY1C,EAAiB,cAAc,eAAe,EAChE,GAAI0C,EAAW,CACb,MAAMC,EAAaD,EAAU,sBAAqB,EAAG,OACrD,OAAO,SAAS,CACd,IAAKC,EAAa,EAClB,SAAU,QAChB,CAAK,CACH,CACF,CAGA,SAASlB,EAAYD,EAAO,CAC1BP,EAAS,MAAM,CACb,MAAO,OACP,QAAS,oBAAoBO,EAAM,OAAO,GAC1C,SAAU,UACd,CAAG,EACD,QAAQ,MAAM,eAAgBA,CAAK,CACrC"}